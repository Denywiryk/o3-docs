# Coding conventions

This is a compendium of the coding conventions we use in O3. The purpose of this document is to help us write code that is consistent and easy to maintain.

## General

### Naming conventions

- Use `camelCase` for variables, functions, and methods.
- Use `kebab-case` for file names and folder names.
- Components should contain the `.component` suffix in their name (e.g. `user.component.tsx`). This nomenclature is used to distinguish components from other files such as resources, stylesheets, and tests, and determines where translation keys and strings should be extracted from.
- Unit and integration test files should contain the `.test` suffix in their name (e.g. `user.test.tsx`). Do not include the word `component` in the test file name.
- Stylesheets should not contain `.component` suffix in their name (e.g. `user.component.scss`). This is because stylesheets are not components, and are not translated. Instead, stylesheets should be named after the component they are styling (e.g. `user.scss`).
- Resource files that encapsulate data fetching logic should contain the `.resource` suffix in their name (e.g. `user.resource.ts`). This is to distinguish them from other files such as components, stylesheets, and tests.
- Follow the guidelines in this [naming cheatsheet](https://github.com/kettanaito/naming-cheatsheet).

### Data fetching

- Data fetching logic should be colocated in a file with the `.resource` suffix. For example, `user.resource.ts` contains the data fetching logic for the user resource.
- Wherever possible, prefer abstracting your data fetching into a custom hook rather than [fetching with effects](https://react.dev/reference/react/useEffect#fetching-data-with-effects). Fetching data with effects has many [downsides](https://react.dev/reference/react/useEffect#fetching-data-with-effects) and should be avoided. Instead, prefer using [SWR](https://swr.vercel.app/) hooks.
- Use [SWR](https://swr.vercel.app/) hooks to fetch data from the backend. Use SWRImmutable for resources that are not expected to change often, such as backend configurations.
- Put the SWR hook in a separate file, and export it as a function. This allows us to reuse the same hook in multiple components.
- Memoize the return value of your SWR hook using `useMemo` to prevent unnecessary rerenders. This is especially important if the hook is used in a component that is rendered many times, such as a table row.
- Data fetching hooks should follow the naming convention `use<resource>`. For example, `useUser` is the hook for fetching user data.
- Use `openmrsFetch` to fetch data from the backend. openmrsFetch is a wrapper around the `fetch` API that adds authentication and authorization headers and handles errors. Pass it to as the `fetcher` argument of your SWR hooks.
- Use `openmrsObservableFetch` if you need to fetch data from the backend using an observable. This is useful for streaming data from the backend. Ensure you understand the difference between observables and promises before reaching for this function.

### State management

- Follow the guidelines outlined [here](https://kentcdodds.com/blog/application-state-management-with-react).
